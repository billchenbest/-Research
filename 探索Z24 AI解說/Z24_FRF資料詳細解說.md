# Z24è³‡æ–™é›†FRFï¼ˆé »ç‡éŸ¿æ‡‰å‡½æ•¸ï¼‰è³‡æ–™è©³ç´°è§£èªª

## ğŸ“‹ ç›®éŒ„

- [ä¸€ã€FRFæ¦‚è¿°](#ä¸€frfæ¦‚è¿°)
- [äºŒã€Z24è³‡æ–™é›†ä¸­FRFç›¸é—œè³‡æ–™](#äºŒz24è³‡æ–™é›†ä¸­frfç›¸é—œè³‡æ–™)
- [ä¸‰ã€FRFè¨ˆç®—æ‰€éœ€çš„åŸå§‹è³‡æ–™](#ä¸‰frfè¨ˆç®—æ‰€éœ€çš„åŸå§‹è³‡æ–™)
- [å››ã€FRFè¨ˆç®—æ–¹æ³•](#å››frfè¨ˆç®—æ–¹æ³•)
- [äº”ã€è³‡æ–™æ ¼å¼èˆ‡çµæ§‹](#äº”è³‡æ–™æ ¼å¼èˆ‡çµæ§‹)
- [å…­ã€FRFè¨ˆç®—å¯¦ä½œç¯„ä¾‹](#å…­frfè¨ˆç®—å¯¦ä½œç¯„ä¾‹)
- [ä¸ƒã€FRFåœ¨æå‚·æª¢æ¸¬ä¸­çš„æ‡‰ç”¨](#ä¸ƒfrfåœ¨æå‚·æª¢æ¸¬ä¸­çš„æ‡‰ç”¨)
- [å…«ã€æ³¨æ„äº‹é …èˆ‡å»ºè­°](#å…«æ³¨æ„äº‹é …èˆ‡å»ºè­°)

---

## ä¸€ã€FRFæ¦‚è¿°

### 1.1 ä»€éº¼æ˜¯FRFï¼ˆé »ç‡éŸ¿æ‡‰å‡½æ•¸ï¼‰ï¼Ÿ

**é »ç‡éŸ¿æ‡‰å‡½æ•¸ï¼ˆFrequency Response Function, FRFï¼‰**æ˜¯æè¿°ç·šæ€§ç³»çµ±åœ¨é »åŸŸä¸­è¼¸å…¥èˆ‡è¼¸å‡ºé—œä¿‚çš„å‡½æ•¸ã€‚åœ¨çµæ§‹å‹•åŠ›å­¸ä¸­ï¼ŒFRFè¡¨ç¤ºçµæ§‹åœ¨ç‰¹å®šé »ç‡ä¸‹çš„éŸ¿æ‡‰ç‰¹æ€§ã€‚

### 1.2 FRFçš„æ•¸å­¸å®šç¾©

å°æ–¼å–®è¼¸å…¥å–®è¼¸å‡ºï¼ˆSISOï¼‰ç³»çµ±ï¼š

\[
H(\omega) = \frac{Y(\omega)}{X(\omega)} = \frac{S_{XY}(\omega)}{S_{XX}(\omega)}
\]

å…¶ä¸­ï¼š
- \(H(\omega)\)ï¼šé »ç‡éŸ¿æ‡‰å‡½æ•¸
- \(Y(\omega)\)ï¼šè¼¸å‡ºä¿¡è™Ÿçš„å‚…ç«‹è‘‰è®Šæ›
- \(X(\omega)\)ï¼šè¼¸å…¥ä¿¡è™Ÿçš„å‚…ç«‹è‘‰è®Šæ›
- \(S_{XY}(\omega)\)ï¼šè¼¸å…¥-è¼¸å‡ºäº¤å‰åŠŸç‡è­œå¯†åº¦
- \(S_{XX}(\omega)\)ï¼šè¼¸å…¥åŠŸç‡è­œå¯†åº¦

### 1.3 FRFçš„é‡è¦æ€§

FRFåœ¨çµæ§‹å¥åº·ç›£æ¸¬ä¸­çš„æ‡‰ç”¨ï¼š

| æ‡‰ç”¨é ˜åŸŸ | èªªæ˜ |
|---------|------|
| **æ¨¡æ…‹åƒæ•¸è­˜åˆ¥** | å¾FRFä¸­æå–è‡ªç„¶é »ç‡ã€æ¨¡æ…‹é˜»å°¼æ¯”ã€æ¨¡æ…‹å½¢ç‹€ |
| **æå‚·æª¢æ¸¬** | æ¯”è¼ƒå¥åº·èˆ‡æå‚·ç‹€æ…‹çš„FRFå·®ç•° |
| **çµæ§‹ç‰¹æ€§åˆ†æ** | è©•ä¼°çµæ§‹å‰›åº¦ã€é˜»å°¼ã€è³ªé‡åˆ†ä½ˆ |
| **æ¨¡å‹é©—è­‰** | é©—è­‰æœ‰é™å…ƒæ¨¡å‹çš„æº–ç¢ºæ€§ |

---

## äºŒã€Z24è³‡æ–™é›†ä¸­FRFç›¸é—œè³‡æ–™

### 2.1 è³‡æ–™é›†æ¦‚è¿°

**é‡è¦ç™¼ç¾ï¼šZ24è³‡æ–™é›†æœ¬èº«ä¸åŒ…å«é å…ˆè¨ˆç®—çš„FRFè³‡æ–™ï¼Œè€Œæ˜¯æä¾›è¨ˆç®—FRFæ‰€éœ€çš„åŸå§‹æ™‚é–“åºåˆ—è³‡æ–™ã€‚**

### 2.2 å¯ç”¨æ–¼FRFè¨ˆç®—çš„è³‡æ–™é¡å‹

#### 2.2.1 ç’°å¢ƒæŒ¯å‹•æ¸¬è©¦ï¼ˆAVTï¼‰è³‡æ–™

**ä½ç½®ï¼š** `pdt_XX/avt/` å’Œ `Z24emsX/`

**è³‡æ–™æ ¼å¼ï¼š**
- `.mat` æª”æ¡ˆï¼šMatlabæ ¼å¼çš„å¤šé€šé“æ™‚é–“åºåˆ—è³‡æ–™
- `.aaa` æª”æ¡ˆï¼šASCIIæ ¼å¼çš„å–®é€šé“æ™‚é–“åºåˆ—è³‡æ–™

**ç‰¹é»ï¼š**
- âœ… åªæœ‰è¼¸å‡ºéŸ¿æ‡‰è³‡æ–™ï¼ˆç„¡å·²çŸ¥è¼¸å…¥ï¼‰
- âœ… ä½¿ç”¨ç’°å¢ƒæ¿€å‹µï¼ˆé¢¨ã€äº¤é€šç­‰ï¼‰
- âœ… é©åˆä½¿ç”¨è¼¸å‡º-è¼¸å‡ºæ–¹æ³•è¨ˆç®—FRF

#### 2.2.2 å¼·è¿«æŒ¯å‹•æ¸¬è©¦ï¼ˆFVTï¼‰è³‡æ–™

**ä½ç½®ï¼š** `pdt_XX/fvt/`

**è³‡æ–™æ ¼å¼ï¼š**
- `.mat` æª”æ¡ˆï¼šMatlabæ ¼å¼çš„å¤šé€šé“æ™‚é–“åºåˆ—è³‡æ–™

**ç‰¹é»ï¼š**
- âœ… åŒ…å«è¼¸å…¥ï¼ˆæ¿€å‹µï¼‰å’Œè¼¸å‡ºï¼ˆéŸ¿æ‡‰ï¼‰è³‡æ–™
- âœ… ä½¿ç”¨å·²çŸ¥çš„æ¿€å‹µä¿¡è™Ÿ
- âœ… å¯ç›´æ¥è¨ˆç®—å‚³çµ±çš„è¼¸å…¥-è¼¸å‡ºFRF

### 2.3 è³‡æ–™çµ±è¨ˆ

| è³‡æ–™é¡å‹ | æª”æ¡ˆæ•¸é‡ | æ¡æ¨£é »ç‡ | æ¨£æœ¬é•·åº¦ | å–®ä½ |
|---------|---------|---------|---------|------|
| **PDTæ¸¬è©¦** | æ¯å€‹æ¸¬è©¦9å€‹è¨­ç½® | 100 Hz | ä¾æª”æ¡ˆè€Œå®š | gï¼ˆé‡åŠ›åŠ é€Ÿåº¦ï¼‰ |
| **EMSç›£æ¸¬** | å¤§é‡æ¸¬é‡é» | 100 Hz | é€šå¸¸65536é» | gï¼ˆé‡åŠ›åŠ é€Ÿåº¦ï¼‰ |
| **è©³ç´°æ¸¬è©¦** | æ¡ˆä¾‹06å’Œ17æœ‰291-309å€‹æª”æ¡ˆ | 100 Hz | 65536é» | gï¼ˆé‡åŠ›åŠ é€Ÿåº¦ï¼‰ |

---

## ä¸‰ã€FRFè¨ˆç®—æ‰€éœ€çš„åŸå§‹è³‡æ–™

### 3.1 è³‡æ–™æ ¼å¼è©³è§£

#### 3.1.1 `.mat` æª”æ¡ˆæ ¼å¼

**æª”æ¡ˆä½ç½®ç¯„ä¾‹ï¼š**
```
pdt_01-08/01/avt/01setup01.mat
pdt_01-08/01/fvt/01setup01.mat
```

**åŒ…å«çš„è®Šæ•¸ï¼š**
- `data`ï¼šæ™‚é–“è³‡æ–™çŸ©é™£
  - æ¯**åˆ—**ï¼ˆrowï¼‰å°æ‡‰ä¸€å€‹æ™‚é–“é»
  - æ¯**è¡Œ**ï¼ˆcolumnï¼‰å°æ‡‰ä¸€å€‹æ¸¬é‡é€šé“
  - å–®ä½ï¼šgï¼ˆé‡åŠ›åŠ é€Ÿåº¦ï¼‰
- `labelshulp`ï¼šé€šé“è³‡è¨Šæ¨™ç±¤
  - åŒ…å«æ¯å€‹é€šé“çš„æ¸¬é‡ä½ç½®è³‡è¨Š

**æŠ€è¡“åƒæ•¸ï¼š**
- æ¡æ¨£é »ç‡ï¼š**100 Hz**ï¼ˆfs = 1 / deltaT = 1 / 0.01 = 100 Hzï¼Œå›ºå®šï¼‰
- æ™‚é–“é–“éš”ï¼š**0.01 ç§’**ï¼ˆdeltaTï¼‰
- å¥ˆå¥æ–¯ç‰¹é »ç‡ï¼š**50 Hz**ï¼ˆf_nyquist = fs / 2 = 100 / 2 = 50 Hzï¼Œæœ€å¤§å¯è§£æé »ç‡ï¼‰

#### 3.1.2 `.aaa` æª”æ¡ˆæ ¼å¼

**æª”æ¡ˆä½ç½®ç¯„ä¾‹ï¼š**
```
Z24ems1/01D00/01D0003.aaa
pdt_01-08/06/avt/01/100V.aaa
```

**æª”æ¡ˆçµæ§‹ï¼š**

```
è¡Œè™Ÿ  å…§å®¹                    èªªæ˜
1     100V.aaa|8Averages      æª”æ¡ˆåç¨±å’Œå¹³å‡æ¬¡æ•¸
2     65536                   æ¨£æœ¬æ•¸é‡
3     0.010000                æ™‚é–“é–“éš”ï¼ˆç§’ï¼‰
4+    åŠ é€Ÿåº¦æ•¸å€¼             æ™‚é–“åºåˆ—è³‡æ–™ï¼ˆå–®ä½ï¼šgï¼‰
...   ...                     ...
çµå°¾  å…ƒæ•¸æ“šè³‡è¨Š              åŒ…å«æ¡é›†åƒæ•¸
```

**å…ƒæ•¸æ“šåŒ…å«ï¼š**
- å–®ä½ï¼šgï¼ˆé‡åŠ›åŠ é€Ÿåº¦ï¼‰
- æ„Ÿæ¸¬å™¨éˆæ•åº¦ï¼š1 V/g
- å¹³å‡æ¬¡æ•¸ï¼šé€šå¸¸ç‚º8
- æ¡é›†æ™‚é–“ï¼šç´„82.398ç§’
- å‰æ¿¾æ³¢å¢ç›Šå’Œå¾Œæ¿¾æ³¢å¢ç›Š
- çµ±è¨ˆè³‡è¨Šï¼ˆæœ€å°å€¼ã€æœ€å¤§å€¼ã€å¹³å‡å€¼ã€æ¨™æº–å·®ï¼‰

### 3.2 è³‡æ–™è®€å–æ–¹æ³•

#### 3.2.1 è®€å–`.mat`æª”æ¡ˆï¼ˆMatlabï¼‰

```matlab
% è¼‰å…¥è³‡æ–™
load('pdt_01-08/01/avt/01setup01.mat');

% è³‡æ–™çµæ§‹
% data: æ™‚é–“è³‡æ–™çŸ©é™£ï¼ˆæ¯åˆ—å°æ‡‰ä¸€å€‹æ™‚é–“é»ï¼Œæ¯è¡Œå°æ‡‰ä¸€å€‹é€šé“ï¼‰
% labelshulp: é€šé“è³‡è¨Š

% è¨­å®šåƒæ•¸
fs = 100;  % æ¡æ¨£é »ç‡ï¼ˆHzï¼‰
dt = 1/fs; % æ™‚é–“é–“éš”ï¼ˆç§’ï¼‰
N = size(data, 1);  % æ¨£æœ¬æ•¸é‡
t = (0:N-1) * dt;    % æ™‚é–“å‘é‡

% æå–ç‰¹å®šé€šé“çš„è³‡æ–™
channel_1 = data(:, 1);  % ç¬¬ä¸€å€‹é€šé“
channel_2 = data(:, 2);  % ç¬¬äºŒå€‹é€šé“
```

#### 3.2.2 è®€å–`.mat`æª”æ¡ˆï¼ˆPythonï¼‰

```python
import scipy.io as sio
import numpy as np

# è¼‰å…¥è³‡æ–™
mat_data = sio.loadmat('pdt_01-08/01/avt/01setup01.mat')

# æå–è³‡æ–™
data = mat_data['data']  # æ™‚é–“è³‡æ–™çŸ©é™£
labelshulp = mat_data['labelshulp']  # é€šé“è³‡è¨Š

# è¨­å®šåƒæ•¸
fs = 100  # æ¡æ¨£é »ç‡ï¼ˆHzï¼‰
dt = 1/fs  # æ™‚é–“é–“éš”ï¼ˆç§’ï¼‰
N = data.shape[0]  # æ¨£æœ¬æ•¸é‡
t = np.arange(N) * dt  # æ™‚é–“å‘é‡

# æå–ç‰¹å®šé€šé“çš„è³‡æ–™
channel_1 = data[:, 0]  # ç¬¬ä¸€å€‹é€šé“
channel_2 = data[:, 1]  # ç¬¬äºŒå€‹é€šé“
```

#### 3.2.3 è®€å–`.aaa`æª”æ¡ˆï¼ˆPythonï¼‰

```python
import numpy as np

def read_aaa_file(filename):
    """
    è®€å–.aaaæ ¼å¼çš„æ™‚é–“æ­·ç¨‹æª”æ¡ˆ
    
    åƒæ•¸:
        filename: æª”æ¡ˆè·¯å¾‘
    
    è¿”å›:
        data: åŠ é€Ÿåº¦è³‡æ–™é™£åˆ—
        dt: æ™‚é–“é–“éš”ï¼ˆç§’ï¼‰
        fs: æ¡æ¨£é »ç‡ï¼ˆHzï¼‰
        metadata: å…ƒæ•¸æ“šå­—å…¸
    """
    with open(filename, 'r') as f:
        lines = f.readlines()
    
    # è®€å–æª”æ¡ˆåç¨±å’Œå¹³å‡æ¬¡æ•¸
    header = lines[0].strip()
    
    # è®€å–æ¨£æœ¬æ•¸å’Œæ™‚é–“é–“éš”
    n_samples = int(lines[1].strip())
    dt = float(lines[2].strip())
    fs = 1.0 / dt
    
    # è®€å–åŠ é€Ÿåº¦è³‡æ–™
    data = []
    metadata_start = False
    metadata = {}
    
    for i in range(3, len(lines)):
        line = lines[i].strip()
        
        # æª¢æŸ¥æ˜¯å¦åˆ°é”å…ƒæ•¸æ“šéƒ¨åˆ†
        if line.startswith('Timehistories end here'):
            metadata_start = True
            continue
        
        if not metadata_start:
            # è®€å–è³‡æ–™
            if line:
                try:
                    data.append(float(line))
                except ValueError:
                    break
        else:
            # è§£æå…ƒæ•¸æ“š
            if ':' in line:
                parts = line.split(':', 1)
                if len(parts) == 2:
                    key = parts[0].strip()
                    value = parts[1].strip()
                    metadata[key] = value
    
    return np.array(data), dt, fs, metadata

# ä½¿ç”¨ç¯„ä¾‹
data, dt, fs, metadata = read_aaa_file('Z24ems1/01D00/01D0003.aaa')
print(f"æ¨£æœ¬æ•¸é‡: {len(data)}")
print(f"æ¡æ¨£é »ç‡: {fs} Hz")
print(f"æ™‚é–“é–“éš”: {dt} ç§’")
```

---

## å››ã€FRFè¨ˆç®—æ–¹æ³•

### 4.1 å¼·è¿«æŒ¯å‹•æ¸¬è©¦ï¼ˆFVTï¼‰çš„FRFè¨ˆç®—

**é©ç”¨æƒ…æ³ï¼š** æœ‰å·²çŸ¥çš„è¼¸å…¥æ¿€å‹µä¿¡è™Ÿ

#### 4.1.1 åŸºæœ¬æ–¹æ³•ï¼šH1ä¼°è¨ˆå™¨

\[
H_1(\omega) = \frac{S_{XY}(\omega)}{S_{XX}(\omega)}
\]

**å„ªé»ï¼š**
- å°è¼¸å‡ºé›œè¨Šä¸æ•æ„Ÿ
- é©åˆè¼¸å…¥ä¿¡è™Ÿé›œè¨Šè¼ƒå°çš„æƒ…æ³

#### 4.1.2 æ›¿ä»£æ–¹æ³•ï¼šH2ä¼°è¨ˆå™¨

\[
H_2(\omega) = \frac{S_{YY}(\omega)}{S_{YX}(\omega)}
\]

**å„ªé»ï¼š**
- å°è¼¸å…¥é›œè¨Šä¸æ•æ„Ÿ
- é©åˆè¼¸å‡ºä¿¡è™Ÿé›œè¨Šè¼ƒå°çš„æƒ…æ³

#### 4.1.3 å¯¦ä½œç¯„ä¾‹ï¼ˆPythonï¼‰

```python
import numpy as np
from scipy import signal

def calculate_frf_h1(input_signal, output_signal, fs, nperseg=None):
    """
    ä½¿ç”¨H1ä¼°è¨ˆå™¨è¨ˆç®—FRF
    
    åƒæ•¸:
        input_signal: è¼¸å…¥ä¿¡è™Ÿï¼ˆæ¿€å‹µï¼‰
        output_signal: è¼¸å‡ºä¿¡è™Ÿï¼ˆéŸ¿æ‡‰ï¼‰
        fs: æ¡æ¨£é »ç‡
        nperseg: æ¯å€‹æ®µçš„é•·åº¦ï¼ˆé è¨­ç‚ºä¿¡è™Ÿé•·åº¦çš„1/4ï¼‰
    
    è¿”å›:
        frequencies: é »ç‡é™£åˆ—
        frf: é »ç‡éŸ¿æ‡‰å‡½æ•¸ï¼ˆè¤‡æ•¸ï¼‰
        coherence: ç›¸å¹²å‡½æ•¸
    """
    if nperseg is None:
        nperseg = len(input_signal) // 4
    
    # è¨ˆç®—äº¤å‰åŠŸç‡è­œå¯†åº¦å’ŒåŠŸç‡è­œå¯†åº¦
    frequencies, Pxy = signal.csd(input_signal, output_signal, 
                                   fs=fs, nperseg=nperseg)
    frequencies, Pxx = signal.welch(input_signal, fs=fs, 
                                     nperseg=nperseg)
    
    # è¨ˆç®—FRF (H1ä¼°è¨ˆå™¨)
    frf = Pxy / Pxx
    
    # è¨ˆç®—ç›¸å¹²å‡½æ•¸
    frequencies, Pyy = signal.welch(output_signal, fs=fs, 
                                     nperseg=nperseg)
    coherence = np.abs(Pxy)**2 / (Pxx * Pyy)
    
    return frequencies, frf, coherence

# ä½¿ç”¨ç¯„ä¾‹
# å‡è¨­å·²è¼‰å…¥è¼¸å…¥å’Œè¼¸å‡ºè³‡æ–™
frequencies, frf, coherence = calculate_frf_h1(input_data, output_data, fs=100)

# ç¹ªè£½FRFå¹…å€¼å’Œç›¸ä½
import matplotlib.pyplot as plt

fig, axes = plt.subplots(3, 1, figsize=(10, 8))

# å¹…å€¼
axes[0].semilogy(frequencies, np.abs(frf))
axes[0].set_xlabel('é »ç‡ (Hz)')
axes[0].set_ylabel('FRF å¹…å€¼')
axes[0].set_title('é »ç‡éŸ¿æ‡‰å‡½æ•¸ - å¹…å€¼')
axes[0].grid(True)

# ç›¸ä½
axes[1].plot(frequencies, np.angle(frf) * 180 / np.pi)
axes[1].set_xlabel('é »ç‡ (Hz)')
axes[1].set_ylabel('ç›¸ä½ (åº¦)')
axes[1].set_title('é »ç‡éŸ¿æ‡‰å‡½æ•¸ - ç›¸ä½')
axes[1].grid(True)

# ç›¸å¹²å‡½æ•¸
axes[2].plot(frequencies, coherence)
axes[2].set_xlabel('é »ç‡ (Hz)')
axes[2].set_ylabel('ç›¸å¹²å‡½æ•¸')
axes[2].set_title('ç›¸å¹²å‡½æ•¸')
axes[2].set_ylim([0, 1])
axes[2].grid(True)

plt.tight_layout()
plt.show()
```

### 4.2 ç’°å¢ƒæŒ¯å‹•æ¸¬è©¦ï¼ˆAVTï¼‰çš„FRFè¨ˆç®—

**é©ç”¨æƒ…æ³ï¼š** åªæœ‰è¼¸å‡ºéŸ¿æ‡‰è³‡æ–™ï¼Œç„¡å·²çŸ¥è¼¸å…¥

#### 4.2.1 è¼¸å‡º-è¼¸å‡ºæ–¹æ³•ï¼šåŠŸç‡è­œå¯†åº¦æ³•

å°æ–¼ç’°å¢ƒæŒ¯å‹•æ¸¬è©¦ï¼Œå¯ä»¥ä½¿ç”¨è¼¸å‡º-è¼¸å‡ºæ–¹æ³•è¨ˆç®—ç­‰æ•ˆFRFï¼š

\[
H_{ij}(\omega) = \frac{S_{Y_i Y_j}(\omega)}{S_{Y_j Y_j}(\omega)}
\]

å…¶ä¸­ï¼š
- \(Y_i\)ï¼šç¬¬iå€‹æ¸¬é‡é»çš„éŸ¿æ‡‰
- \(Y_j\)ï¼šåƒè€ƒæ¸¬é‡é»çš„éŸ¿æ‡‰ï¼ˆé€šå¸¸é¸æ“‡éŸ¿æ‡‰è¼ƒå¤§çš„é»ï¼‰

#### 4.2.2 å¯¦ä½œç¯„ä¾‹ï¼ˆPythonï¼‰

```python
import numpy as np
from scipy import signal

def calculate_frf_avt(reference_signal, response_signal, fs, nperseg=None):
    """
    å¾ç’°å¢ƒæŒ¯å‹•æ¸¬è©¦è³‡æ–™è¨ˆç®—FRF
    
    åƒæ•¸:
        reference_signal: åƒè€ƒé€šé“ä¿¡è™Ÿ
        response_signal: éŸ¿æ‡‰é€šé“ä¿¡è™Ÿ
        fs: æ¡æ¨£é »ç‡
        nperseg: æ¯å€‹æ®µçš„é•·åº¦
    
    è¿”å›:
        frequencies: é »ç‡é™£åˆ—
        frf: é »ç‡éŸ¿æ‡‰å‡½æ•¸ï¼ˆè¤‡æ•¸ï¼‰
        coherence: ç›¸å¹²å‡½æ•¸
    """
    if nperseg is None:
        nperseg = len(reference_signal) // 4
    
    # è¨ˆç®—äº¤å‰åŠŸç‡è­œå¯†åº¦
    frequencies, Pxy = signal.csd(response_signal, reference_signal, 
                                   fs=fs, nperseg=nperseg)
    
    # è¨ˆç®—åƒè€ƒé€šé“çš„åŠŸç‡è­œå¯†åº¦
    frequencies, Prr = signal.welch(reference_signal, fs=fs, 
                                     nperseg=nperseg)
    
    # è¨ˆç®—éŸ¿æ‡‰é€šé“çš„åŠŸç‡è­œå¯†åº¦
    frequencies, Pyy = signal.welch(response_signal, fs=fs, 
                                     nperseg=nperseg)
    
    # è¨ˆç®—FRF
    frf = Pxy / Prr
    
    # è¨ˆç®—ç›¸å¹²å‡½æ•¸
    coherence = np.abs(Pxy)**2 / (Prr * Pyy)
    
    return frequencies, frf, coherence

# ä½¿ç”¨ç¯„ä¾‹
# å¾.matæª”æ¡ˆè¼‰å…¥å¤šé€šé“è³‡æ–™
mat_data = sio.loadmat('pdt_01-08/01/avt/01setup01.mat')
data = mat_data['data']

# é¸æ“‡åƒè€ƒé€šé“ï¼ˆä¾‹å¦‚ç¬¬ä¸€å€‹é€šé“ï¼‰
reference_channel = data[:, 0]

# è¨ˆç®—å…¶ä»–é€šé“ç›¸å°æ–¼åƒè€ƒé€šé“çš„FRF
frf_results = []
for i in range(1, data.shape[1]):
    response_channel = data[:, i]
    frequencies, frf, coherence = calculate_frf_avt(
        reference_channel, response_channel, fs=100
    )
    frf_results.append({
        'channel': i,
        'frequencies': frequencies,
        'frf': frf,
        'coherence': coherence
    })
```

### 4.3 å¤šè¼¸å…¥å¤šè¼¸å‡ºï¼ˆMIMOï¼‰FRFè¨ˆç®—

å°æ–¼å¤šé€šé“è³‡æ–™ï¼Œå¯ä»¥è¨ˆç®—å®Œæ•´çš„FRFçŸ©é™£ï¼š

\[
[H(\omega)] = [S_{YY}(\omega)] [S_{XX}(\omega)]^{-1}
\]

**å¯¦ä½œç¯„ä¾‹ï¼š**

```python
def calculate_mimo_frf(input_data, output_data, fs, nperseg=None):
    """
    è¨ˆç®—å¤šè¼¸å…¥å¤šè¼¸å‡ºFRFçŸ©é™£
    
    åƒæ•¸:
        input_data: è¼¸å…¥è³‡æ–™çŸ©é™£ï¼ˆæ™‚é–“ x è¼¸å…¥é€šé“ï¼‰
        output_data: è¼¸å‡ºè³‡æ–™çŸ©é™£ï¼ˆæ™‚é–“ x è¼¸å‡ºé€šé“ï¼‰
        fs: æ¡æ¨£é »ç‡
        nperseg: æ¯å€‹æ®µçš„é•·åº¦
    
    è¿”å›:
        frequencies: é »ç‡é™£åˆ—
        frf_matrix: FRFçŸ©é™£ï¼ˆé »ç‡ x è¼¸å‡ºé€šé“ x è¼¸å…¥é€šé“ï¼‰
    """
    n_inputs = input_data.shape[1]
    n_outputs = output_data.shape[1]
    
    if nperseg is None:
        nperseg = input_data.shape[0] // 4
    
    # åˆå§‹åŒ–FRFçŸ©é™£
    frequencies = None
    frf_matrix = None
    
    # è¨ˆç®—æ¯å€‹è¼¸å…¥-è¼¸å‡ºå°çš„FRF
    for i in range(n_inputs):
        for j in range(n_outputs):
            freq, frf, _ = calculate_frf_h1(
                input_data[:, i], output_data[:, j], fs, nperseg
            )
            
            if frequencies is None:
                frequencies = freq
                frf_matrix = np.zeros(
                    (len(freq), n_outputs, n_inputs), 
                    dtype=complex
                )
            
            frf_matrix[:, j, i] = frf
    
    return frequencies, frf_matrix
```

---

## äº”ã€è³‡æ–™æ ¼å¼èˆ‡çµæ§‹

### 5.1 è³‡æ–™çµ„ç¹”çµæ§‹

#### 5.1.1 PDTæ¸¬è©¦è³‡æ–™çµæ§‹

```
pdt_01-08/
â”œâ”€â”€ 01/
â”‚   â”œâ”€â”€ avt/              # ç’°å¢ƒæŒ¯å‹•æ¸¬è©¦
â”‚   â”‚   â”œâ”€â”€ 01setup01.mat
â”‚   â”‚   â”œâ”€â”€ 01setup02.mat
â”‚   â”‚   â””â”€â”€ ...
â”‚   â””â”€â”€ fvt/              # å¼·è¿«æŒ¯å‹•æ¸¬è©¦
â”‚       â”œâ”€â”€ 01setup01.mat
â”‚       â”œâ”€â”€ 01setup02.mat
â”‚       â””â”€â”€ ...
â”œâ”€â”€ 02/
â”‚   â””â”€â”€ ...
â””â”€â”€ ...
```

**å‘½åè¦å‰‡ï¼š**
- `XXsetupYY.mat`ï¼šXXç‚ºæ¸¬è©¦ç·¨è™Ÿï¼ŒYYç‚ºè¨­ç½®ç·¨è™Ÿï¼ˆ01-09ï¼‰
- setup01é€šå¸¸ç‚ºå¥åº·åŸºæº–ç‹€æ…‹
- setup02-09ç‚ºä¸åŒçš„æå‚·ç‹€æ…‹æˆ–æ¸¬è©¦æ¢ä»¶

#### 5.1.2 EMSç›£æ¸¬è³‡æ–™çµæ§‹

```
Z24ems1/
â”œâ”€â”€ 01D00/                # å¥åº·åŸºæº–ï¼šæ¸¬è©¦01ï¼Œä½ç½®D
â”‚   â”œâ”€â”€ 01D0003.aaa
â”‚   â”œâ”€â”€ 01D0005.aaa
â”‚   â”œâ”€â”€ ...
â”‚   â”œâ”€â”€ 01D00PRE.env
â”‚   â””â”€â”€ 01D00POS.env
â”œâ”€â”€ 01D01/                # æå‚·ç‹€æ…‹1ï¼šæ¸¬è©¦01ï¼Œä½ç½®D
â”‚   â”œâ”€â”€ 01D0103.aaa
â”‚   â”œâ”€â”€ ...
â”‚   â”œâ”€â”€ 01D01PRE.env
â”‚   â””â”€â”€ 01D01POS.env
â””â”€â”€ ...
```

**å‘½åè¦å‰‡ï¼š**
- `XXYYZZ`ï¼šXXç‚ºæ¸¬è©¦ç·¨è™Ÿï¼ŒYYç‚ºä½ç½®ï¼ˆA-Gï¼‰ï¼ŒZZç‚ºç‹€æ…‹ï¼ˆ00=å¥åº·ï¼Œ01-23=æå‚·ï¼‰
- `.aaa`æª”æ¡ˆï¼šæ™‚é–“åºåˆ—è³‡æ–™
  - æª”æ¡ˆåç¨±ä¸­çš„é€šé“è™Ÿç¢¼ï¼ˆå…©ä½æ•¸ï¼‰å°æ‡‰åˆ° Fig. 37 ä¸­çš„åŠ é€Ÿè¨ˆä½ç½®
  - ä¾‹å¦‚ï¼š`13A2305.AAA` = ç¬¬13é€±ï¼Œæ˜ŸæœŸä¸€ï¼Œ23æ™‚ï¼Œé€šé“05ï¼ˆZurichæ–¹å‘æœ€å·¦å´å¤–ç·£ï¼‰
- `PRE.env`å’Œ`POS.env`ï¼šç’°å¢ƒç›£æ¸¬è³‡æ–™
  - **è©³ç´°é€šé“å®šç¾©è«‹åƒè€ƒï¼š** `Z24_é»ä½åˆ†å¸ƒèˆ‡é€šé“å®šç¾©.md`

### 5.2 è³‡æ–™å“è³ªæŒ‡æ¨™

#### 5.2.1 ç›¸å¹²å‡½æ•¸ï¼ˆCoherenceï¼‰

ç›¸å¹²å‡½æ•¸ç”¨æ–¼è©•ä¼°FRFè¨ˆç®—çš„å¯é æ€§ï¼š

\[
\gamma^2(\omega) = \frac{|S_{XY}(\omega)|^2}{S_{XX}(\omega) S_{YY}(\omega)}
\]

**è§£é‡‹ï¼š**
- \(\gamma^2 = 1\)ï¼šå®Œå…¨ç›¸å¹²ï¼ŒFRFå¯é 
- \(\gamma^2 < 0.7\)ï¼šç›¸å¹²æ€§è¼ƒå·®ï¼ŒFRFå¯èƒ½ä¸å¯é 
- \(\gamma^2 < 0.5\)ï¼šç›¸å¹²æ€§å¾ˆå·®ï¼Œä¸å»ºè­°ä½¿ç”¨è©²é »æ®µçš„FRF

#### 5.2.2 ä¿¡å™ªæ¯”ï¼ˆSNRï¼‰

è©•ä¼°ä¿¡è™Ÿå“è³ªï¼š

\[
SNR = 10 \log_{10} \frac{P_{signal}}{P_{noise}}
\]

---

## å…­ã€FRFè¨ˆç®—å¯¦ä½œç¯„ä¾‹

### 6.1 å®Œæ•´ç¯„ä¾‹ï¼šå¾Z24è³‡æ–™è¨ˆç®—FRF

```python
import numpy as np
import scipy.io as sio
from scipy import signal
import matplotlib.pyplot as plt

def load_z24_mat_file(filepath):
    """è¼‰å…¥Z24çš„.matæª”æ¡ˆ"""
    mat_data = sio.loadmat(filepath)
    data = mat_data['data']
    labelshulp = mat_data.get('labelshulp', None)
    return data, labelshulp

def calculate_frf_from_z24(filepath, reference_channel=0, 
                           response_channel=1, fs=100, 
                           nperseg=None, window='hann'):
    """
    å¾Z24è³‡æ–™è¨ˆç®—FRF
    
    åƒæ•¸:
        filepath: .matæª”æ¡ˆè·¯å¾‘
        reference_channel: åƒè€ƒé€šé“ç´¢å¼•
        response_channel: éŸ¿æ‡‰é€šé“ç´¢å¼•
        fs: æ¡æ¨£é »ç‡ï¼ˆé è¨­100 Hzï¼‰
        nperseg: æ¯å€‹æ®µçš„é•·åº¦
        window: çª—å‡½æ•¸é¡å‹
    
    è¿”å›:
        frequencies: é »ç‡é™£åˆ—
        frf: é »ç‡éŸ¿æ‡‰å‡½æ•¸
        coherence: ç›¸å¹²å‡½æ•¸
    """
    # è¼‰å…¥è³‡æ–™
    data, labelshulp = load_z24_mat_file(filepath)
    
    # æå–é€šé“è³‡æ–™
    ref_signal = data[:, reference_channel]
    resp_signal = data[:, response_channel]
    
    # è¨­å®šåƒæ•¸
    if nperseg is None:
        nperseg = len(ref_signal) // 4
    
    # è¨ˆç®—åŠŸç‡è­œå¯†åº¦
    frequencies, Pxy = signal.csd(
        resp_signal, ref_signal, 
        fs=fs, nperseg=nperseg, 
        window=window, noverlap=nperseg//2
    )
    
    frequencies, Prr = signal.welch(
        ref_signal, fs=fs, nperseg=nperseg,
        window=window, noverlap=nperseg//2
    )
    
    frequencies, Pyy = signal.welch(
        resp_signal, fs=fs, nperseg=nperseg,
        window=window, noverlap=nperseg//2
    )
    
    # è¨ˆç®—FRF
    frf = Pxy / Prr
    
    # è¨ˆç®—ç›¸å¹²å‡½æ•¸
    coherence = np.abs(Pxy)**2 / (Prr * Pyy)
    
    return frequencies, frf, coherence

# ä½¿ç”¨ç¯„ä¾‹
# è¨ˆç®—å¥åº·åŸºæº–ç‹€æ…‹çš„FRF
healthy_file = 'pdt_01-08/01/avt/01setup01.mat'
freq_healthy, frf_healthy, coh_healthy = calculate_frf_from_z24(
    healthy_file, reference_channel=0, response_channel=1
)

# è¨ˆç®—æå‚·ç‹€æ…‹çš„FRF
damaged_file = 'pdt_01-08/01/avt/01setup02.mat'
freq_damaged, frf_damaged, coh_damaged = calculate_frf_from_z24(
    damaged_file, reference_channel=0, response_channel=1
)

# ç¹ªè£½æ¯”è¼ƒåœ–
fig, axes = plt.subplots(3, 1, figsize=(12, 10))

# FRFå¹…å€¼æ¯”è¼ƒ
axes[0].semilogy(freq_healthy, np.abs(frf_healthy), 
                 label='å¥åº·ç‹€æ…‹', linewidth=2)
axes[0].semilogy(freq_damaged, np.abs(frf_damaged), 
                 label='æå‚·ç‹€æ…‹', linewidth=2)
axes[0].set_xlabel('é »ç‡ (Hz)')
axes[0].set_ylabel('FRF å¹…å€¼')
axes[0].set_title('FRFå¹…å€¼æ¯”è¼ƒ')
axes[0].legend()
axes[0].grid(True, alpha=0.3)

# FRFç›¸ä½æ¯”è¼ƒ
axes[1].plot(freq_healthy, np.angle(frf_healthy) * 180 / np.pi, 
             label='å¥åº·ç‹€æ…‹', linewidth=2)
axes[1].plot(freq_damaged, np.angle(frf_damaged) * 180 / np.pi, 
             label='æå‚·ç‹€æ…‹', linewidth=2)
axes[1].set_xlabel('é »ç‡ (Hz)')
axes[1].set_ylabel('ç›¸ä½ (åº¦)')
axes[1].set_title('FRFç›¸ä½æ¯”è¼ƒ')
axes[1].legend()
axes[1].grid(True, alpha=0.3)

# ç›¸å¹²å‡½æ•¸æ¯”è¼ƒ
axes[2].plot(freq_healthy, coh_healthy, 
             label='å¥åº·ç‹€æ…‹', linewidth=2)
axes[2].plot(freq_damaged, coh_damaged, 
             label='æå‚·ç‹€æ…‹', linewidth=2)
axes[2].axhline(y=0.7, color='r', linestyle='--', 
                label='ç›¸å¹²æ€§é–¾å€¼ (0.7)')
axes[2].set_xlabel('é »ç‡ (Hz)')
axes[2].set_ylabel('ç›¸å¹²å‡½æ•¸')
axes[2].set_title('ç›¸å¹²å‡½æ•¸æ¯”è¼ƒ')
axes[2].set_ylim([0, 1])
axes[2].legend()
axes[2].grid(True, alpha=0.3)

plt.tight_layout()
plt.show()
```

### 6.2 æ‰¹é‡è™•ç†å¤šå€‹æª”æ¡ˆ

```python
import os
import glob

def batch_calculate_frf(data_dir, output_dir, reference_channel=0, 
                        response_channel=1, fs=100):
    """
    æ‰¹é‡è¨ˆç®—FRF
    
    åƒæ•¸:
        data_dir: è³‡æ–™ç›®éŒ„
        output_dir: è¼¸å‡ºç›®éŒ„
        reference_channel: åƒè€ƒé€šé“
        response_channel: éŸ¿æ‡‰é€šé“
        fs: æ¡æ¨£é »ç‡
    """
    # å°‹æ‰¾æ‰€æœ‰.matæª”æ¡ˆ
    mat_files = glob.glob(os.path.join(data_dir, '**/*.mat'), 
                          recursive=True)
    
    results = []
    
    for mat_file in mat_files:
        try:
            frequencies, frf, coherence = calculate_frf_from_z24(
                mat_file, reference_channel, response_channel, fs
            )
            
            # å„²å­˜çµæœ
            result = {
                'filepath': mat_file,
                'frequencies': frequencies,
                'frf': frf,
                'coherence': coherence,
                'mean_coherence': np.mean(coherence)
            }
            
            results.append(result)
            
            # å„²å­˜åˆ°æª”æ¡ˆ
            output_file = os.path.join(
                output_dir, 
                os.path.basename(mat_file).replace('.mat', '_frf.npy')
            )
            np.save(output_file, result)
            
        except Exception as e:
            print(f"è™•ç†æª”æ¡ˆ {mat_file} æ™‚ç™¼ç”ŸéŒ¯èª¤: {e}")
    
    return results

# ä½¿ç”¨ç¯„ä¾‹
results = batch_calculate_frf(
    'pdt_01-08/01/avt',
    'frf_results',
    reference_channel=0,
    response_channel=1
)
```

---

## ä¸ƒã€FRFåœ¨æå‚·æª¢æ¸¬ä¸­çš„æ‡‰ç”¨

### 7.1 æå‚·æŒ‡æ¨™

#### 7.1.1 FRFå¹…å€¼è®ŠåŒ–

æ¯”è¼ƒå¥åº·èˆ‡æå‚·ç‹€æ…‹çš„FRFå¹…å€¼å·®ç•°ï¼š

\[
DI_{magnitude}(\omega) = \frac{|H_{damaged}(\omega)| - |H_{healthy}(\omega)|}{|H_{healthy}(\omega)|}
\]

#### 7.1.2 FRFç›¸ä½è®ŠåŒ–

æ¯”è¼ƒå¥åº·èˆ‡æå‚·ç‹€æ…‹çš„FRFç›¸ä½å·®ç•°ï¼š

\[
DI_{phase}(\omega) = |\angle H_{damaged}(\omega) - \angle H_{healthy}(\omega)|
\]

#### 7.1.3 FRFå¯¦éƒ¨èˆ‡è™›éƒ¨è®ŠåŒ–

åˆ†æFRFçš„å¯¦éƒ¨å’Œè™›éƒ¨è®ŠåŒ–ï¼š

\[
DI_{real}(\omega) = \frac{Re[H_{damaged}(\omega)] - Re[H_{healthy}(\omega)]}{Re[H_{healthy}(\omega)]}
\]

\[
DI_{imaginary}(\omega) = \frac{Im[H_{damaged}(\omega)] - Im[H_{healthy}(\omega)]}{Im[H_{healthy}(\omega)]}
\]

### 7.2 å¯¦ä½œç¯„ä¾‹ï¼šæå‚·æª¢æ¸¬

```python
def calculate_damage_indicator(frf_healthy, frf_damaged, frequencies):
    """
    è¨ˆç®—æå‚·æŒ‡æ¨™
    
    åƒæ•¸:
        frf_healthy: å¥åº·ç‹€æ…‹çš„FRF
        frf_damaged: æå‚·ç‹€æ…‹çš„FRF
        frequencies: é »ç‡é™£åˆ—
    
    è¿”å›:
        damage_indicators: æå‚·æŒ‡æ¨™å­—å…¸
    """
    # FRFå¹…å€¼è®ŠåŒ–
    magnitude_change = (
        np.abs(frf_damaged) - np.abs(frf_healthy)
    ) / np.abs(frf_healthy)
    
    # FRFç›¸ä½è®ŠåŒ–
    phase_change = np.abs(
        np.angle(frf_damaged) - np.angle(frf_healthy)
    ) * 180 / np.pi
    
    # FRFå¯¦éƒ¨è®ŠåŒ–
    real_change = (
        np.real(frf_damaged) - np.real(frf_healthy)
    ) / np.real(frf_healthy)
    
    # FRFè™›éƒ¨è®ŠåŒ–
    imag_change = (
        np.imag(frf_damaged) - np.imag(frf_healthy)
    ) / np.imag(frf_healthy)
    
    # è¨ˆç®—ç¸½é«”æå‚·æŒ‡æ¨™ï¼ˆRMSï¼‰
    rms_magnitude = np.sqrt(np.mean(magnitude_change**2))
    rms_phase = np.sqrt(np.mean(phase_change**2))
    rms_real = np.sqrt(np.mean(real_change**2))
    rms_imag = np.sqrt(np.mean(imag_change**2))
    
    return {
        'frequencies': frequencies,
        'magnitude_change': magnitude_change,
        'phase_change': phase_change,
        'real_change': real_change,
        'imaginary_change': imag_change,
        'rms_magnitude': rms_magnitude,
        'rms_phase': rms_phase,
        'rms_real': rms_real,
        'rms_imaginary': rms_imag
    }

# ä½¿ç”¨ç¯„ä¾‹
damage_indicators = calculate_damage_indicator(
    frf_healthy, frf_damaged, freq_healthy
)

# ç¹ªè£½æå‚·æŒ‡æ¨™
fig, axes = plt.subplots(2, 2, figsize=(14, 10))

# å¹…å€¼è®ŠåŒ–
axes[0, 0].plot(damage_indicators['frequencies'], 
                damage_indicators['magnitude_change'])
axes[0, 0].set_xlabel('é »ç‡ (Hz)')
axes[0, 0].set_ylabel('å¹…å€¼è®ŠåŒ–')
axes[0, 0].set_title('FRFå¹…å€¼è®ŠåŒ–')
axes[0, 0].grid(True, alpha=0.3)
axes[0, 0].axhline(y=0, color='k', linestyle='--')

# ç›¸ä½è®ŠåŒ–
axes[0, 1].plot(damage_indicators['frequencies'], 
                damage_indicators['phase_change'])
axes[0, 1].set_xlabel('é »ç‡ (Hz)')
axes[0, 1].set_ylabel('ç›¸ä½è®ŠåŒ– (åº¦)')
axes[0, 1].set_title('FRFç›¸ä½è®ŠåŒ–')
axes[0, 1].grid(True, alpha=0.3)

# å¯¦éƒ¨è®ŠåŒ–
axes[1, 0].plot(damage_indicators['frequencies'], 
                damage_indicators['real_change'])
axes[1, 0].set_xlabel('é »ç‡ (Hz)')
axes[1, 0].set_ylabel('å¯¦éƒ¨è®ŠåŒ–')
axes[1, 0].set_title('FRFå¯¦éƒ¨è®ŠåŒ–')
axes[1, 0].grid(True, alpha=0.3)
axes[1, 0].axhline(y=0, color='k', linestyle='--')

# è™›éƒ¨è®ŠåŒ–
axes[1, 1].plot(damage_indicators['frequencies'], 
                damage_indicators['imaginary_change'])
axes[1, 1].set_xlabel('é »ç‡ (Hz)')
axes[1, 1].set_ylabel('è™›éƒ¨è®ŠåŒ–')
axes[1, 1].set_title('FRFè™›éƒ¨è®ŠåŒ–')
axes[1, 1].grid(True, alpha=0.3)
axes[1, 1].axhline(y=0, color='k', linestyle='--')

plt.tight_layout()
plt.show()

# è¼¸å‡ºç¸½é«”æå‚·æŒ‡æ¨™
print(f"RMSå¹…å€¼è®ŠåŒ–: {damage_indicators['rms_magnitude']:.4f}")
print(f"RMSç›¸ä½è®ŠåŒ–: {damage_indicators['rms_phase']:.4f} åº¦")
print(f"RMSå¯¦éƒ¨è®ŠåŒ–: {damage_indicators['rms_real']:.4f}")
print(f"RMSè™›éƒ¨è®ŠåŒ–: {damage_indicators['rms_imaginary']:.4f}")
```

---

## å…«ã€æ³¨æ„äº‹é …èˆ‡å»ºè­°

### 8.1 è³‡æ–™å“è³ªæª¢æŸ¥

#### 8.1.1 æª¢æŸ¥æ¸…å–®

åœ¨è¨ˆç®—FRFä¹‹å‰ï¼Œå»ºè­°æª¢æŸ¥ï¼š

- âœ… **è³‡æ–™å®Œæ•´æ€§**ï¼šç¢ºèªè³‡æ–™æ²’æœ‰ç¼ºå¤±å€¼æˆ–ç•°å¸¸å€¼
- âœ… **æ¡æ¨£é »ç‡ä¸€è‡´æ€§**ï¼šç¢ºèªæ‰€æœ‰è³‡æ–™ä½¿ç”¨ç›¸åŒçš„æ¡æ¨£é »ç‡ï¼ˆ100 Hzï¼‰
- âœ… **æ™‚é–“åŒæ­¥**ï¼šç¢ºèªå¤šé€šé“è³‡æ–™æ™‚é–“åŒæ­¥
- âœ… **ä¿¡è™Ÿå“è³ª**ï¼šæª¢æŸ¥ä¿¡è™Ÿæ˜¯å¦æœ‰æ˜é¡¯çš„é›œè¨Šæˆ–å¹²æ“¾

#### 8.1.2 è³‡æ–™é è™•ç†

```python
def preprocess_signal(signal, fs, remove_dc=True, 
                      detrend=True, filter_noise=True):
    """
    ä¿¡è™Ÿé è™•ç†
    
    åƒæ•¸:
        signal: åŸå§‹ä¿¡è™Ÿ
        fs: æ¡æ¨£é »ç‡
        remove_dc: æ˜¯å¦ç§»é™¤ç›´æµåˆ†é‡
        detrend: æ˜¯å¦å»è¶¨å‹¢
        filter_noise: æ˜¯å¦æ¿¾é™¤é›œè¨Š
    
    è¿”å›:
        processed_signal: è™•ç†å¾Œçš„ä¿¡è™Ÿ
    """
    processed = signal.copy()
    
    # ç§»é™¤ç›´æµåˆ†é‡
    if remove_dc:
        processed = processed - np.mean(processed)
    
    # å»è¶¨å‹¢
    if detrend:
        from scipy import signal as scipy_signal
        processed = scipy_signal.detrend(processed)
    
    # æ¿¾é™¤é›œè¨Šï¼ˆå¯é¸çš„ä½é€šæ¿¾æ³¢ï¼‰
    if filter_noise:
        from scipy import signal as scipy_signal
        # è¨­è¨ˆä½é€šæ¿¾æ³¢å™¨ï¼ˆæˆªæ­¢é »ç‡ç‚ºNyquisté »ç‡çš„0.8å€ï¼‰
        nyquist = fs / 2
        cutoff = 0.8 * nyquist
        b, a = scipy_signal.butter(4, cutoff / nyquist, 'low')
        processed = scipy_signal.filtfilt(b, a, processed)
    
    return processed
```

### 8.2 FRFè¨ˆç®—åƒæ•¸é¸æ“‡

#### 8.2.1 çª—å‡½æ•¸é¸æ“‡

| çª—å‡½æ•¸ | å„ªé» | ç¼ºé» | é©ç”¨å ´æ™¯ |
|--------|------|------|---------|
| **Hanning** | é »ç‡è§£æåº¦å¥½ï¼Œæ—ç“£æŠ‘åˆ¶å¥½ | é »è­œæ´©æ¼ | ä¸€èˆ¬ç”¨é€”ï¼ˆæ¨è–¦ï¼‰ |
| **Hamming** | æ—ç“£æŠ‘åˆ¶å¥½ | é »ç‡è§£æåº¦ç¨å·® | ä¿¡è™Ÿè¼ƒå¼±æ™‚ |
| **Blackman** | æ—ç“£æŠ‘åˆ¶æœ€å¥½ | é »ç‡è§£æåº¦è¼ƒå·® | å¼·é›œè¨Šç’°å¢ƒ |
| **çŸ©å½¢** | é »ç‡è§£æåº¦æœ€å¥½ | é »è­œæ´©æ¼åš´é‡ | ä¸æ¨è–¦ |

#### 8.2.2 æ®µé•·åº¦ï¼ˆnpersegï¼‰é¸æ“‡

- **è¼ƒé•·çš„æ®µ**ï¼šé »ç‡è§£æåº¦é«˜ï¼Œä½†çµ±è¨ˆç©©å®šæ€§å·®
- **è¼ƒçŸ­çš„æ®µ**ï¼šçµ±è¨ˆç©©å®šæ€§å¥½ï¼Œä½†é »ç‡è§£æåº¦ä½
- **å»ºè­°**ï¼šä½¿ç”¨ä¿¡è™Ÿé•·åº¦çš„1/4åˆ°1/8

#### 8.2.3 é‡ç–Šç‡é¸æ“‡

- **å»ºè­°é‡ç–Šç‡**ï¼š50%ï¼ˆnoverlap = nperseg // 2ï¼‰
- **å„ªé»**ï¼šæé«˜çµ±è¨ˆç©©å®šæ€§ï¼Œæ¸›å°‘è³‡æ–™æµªè²»

### 8.3 å¸¸è¦‹å•é¡Œèˆ‡è§£æ±ºæ–¹æ¡ˆ

#### 8.3.1 å•é¡Œï¼šFRFåœ¨æŸäº›é »æ®µä¸å¯é 

**åŸå› ï¼š**
- ç›¸å¹²å‡½æ•¸éä½
- ä¿¡è™Ÿå¼·åº¦ä¸è¶³
- é›œè¨Šå¹²æ“¾

**è§£æ±ºæ–¹æ¡ˆï¼š**
- æª¢æŸ¥ç›¸å¹²å‡½æ•¸ï¼Œåªä½¿ç”¨ç›¸å¹²å‡½æ•¸ > 0.7 çš„é »æ®µ
- å¢åŠ å¹³å‡æ¬¡æ•¸
- æ”¹å–„ä¿¡è™Ÿå“è³ª

#### 8.3.2 å•é¡Œï¼šFRFå¹…å€¼ç•°å¸¸

**åŸå› ï¼š**
- è¼¸å…¥ä¿¡è™Ÿéå°ï¼ˆæ¥è¿‘é›œè¨Šæ°´å¹³ï¼‰
- é »ç‡è§£æåº¦ä¸è¶³
- çª—å‡½æ•¸é¸æ“‡ä¸ç•¶

**è§£æ±ºæ–¹æ¡ˆï¼š**
- æª¢æŸ¥è¼¸å…¥ä¿¡è™Ÿçš„åŠŸç‡è­œå¯†åº¦
- èª¿æ•´æ®µé•·åº¦
- å˜—è©¦ä¸åŒçš„çª—å‡½æ•¸

#### 8.3.3 å•é¡Œï¼šå¤šé€šé“è³‡æ–™åŒæ­¥å•é¡Œ

**åŸå› ï¼š**
- æ¡æ¨£æ™‚é˜ä¸åŒæ­¥
- è³‡æ–™è®€å–éŒ¯èª¤

**è§£æ±ºæ–¹æ¡ˆï¼š**
- ç¢ºèªæ‰€æœ‰é€šé“ä½¿ç”¨ç›¸åŒçš„æ™‚é–“å‘é‡
- æª¢æŸ¥è³‡æ–™é•·åº¦æ˜¯å¦ä¸€è‡´

### 8.4 æœ€ä½³å¯¦è¸å»ºè­°

1. **è³‡æ–™é©—è­‰**
   - å§‹çµ‚æª¢æŸ¥ç›¸å¹²å‡½æ•¸
   - é©—è­‰FRFçš„åˆç†æ€§ï¼ˆå¹…å€¼ã€ç›¸ä½é€£çºŒæ€§ï¼‰

2. **åƒæ•¸é¸æ“‡**
   - ä½¿ç”¨Hanningçª—å‡½æ•¸ï¼ˆä¸€èˆ¬æƒ…æ³ï¼‰
   - æ®µé•·åº¦è¨­ç‚ºä¿¡è™Ÿé•·åº¦çš„1/4
   - é‡ç–Šç‡è¨­ç‚º50%

3. **çµæœé©—è­‰**
   - æ¯”è¼ƒä¸åŒä¼°è¨ˆå™¨ï¼ˆH1 vs H2ï¼‰çš„çµæœ
   - æª¢æŸ¥FRFçš„ç‰©ç†åˆç†æ€§
   - é©—è­‰æ¨¡æ…‹é »ç‡æ˜¯å¦åœ¨åˆç†ç¯„åœå…§

4. **æå‚·æª¢æ¸¬**
   - ä½¿ç”¨å¤šå€‹æå‚·æŒ‡æ¨™çš„çµ„åˆ
   - è€ƒæ…®ç’°å¢ƒå› ç´ çš„å½±éŸ¿
   - å»ºç«‹çµ±è¨ˆåŸºæº–

---

## é™„éŒ„ï¼šåƒè€ƒè³‡æ–™

### A. ç›¸é—œæª”æ¡ˆä½ç½®

- **PDTæ¸¬è©¦è³‡æ–™**ï¼š`pdt_01-08/` å’Œ `pdt_09-17/`
- **EMSç›£æ¸¬è³‡æ–™**ï¼š`Z24ems1/`, `Z24ems2/`, `Z24ems3/`
- **èªªæ˜æ–‡ä»¶**ï¼š`readme.txt`, `Z24-EMS-readme.pdf`
- **é»ä½åˆ†å¸ƒèˆ‡é€šé“å®šç¾©**ï¼š`Z24_é»ä½åˆ†å¸ƒèˆ‡é€šé“å®šç¾©.md`ï¼ˆæ–°å¢ï¼‰

### B. æŠ€è¡“è¦æ ¼æ‘˜è¦

| åƒæ•¸ | æ•¸å€¼ | èªªæ˜ |
|------|------|------|
| æ¡æ¨£é »ç‡ | 100 Hz | fs = 1 / deltaT = 1 / 0.01 = 100 Hz |
| æ™‚é–“é–“éš” | 0.01 ç§’ | deltaT |
| å¥ˆå¥æ–¯ç‰¹é »ç‡ | 50 Hz | f_nyquist = fs / 2 = 100 / 2 = 50 Hzï¼ˆæœ€å¤§å¯è§£æé »ç‡ï¼‰ |
| æ¨£æœ¬é•·åº¦ï¼ˆ.aaaæª”æ¡ˆï¼‰ | é€šå¸¸ 65536 é» | ç´„ 655.36 ç§’ |
| è³‡æ–™å–®ä½ | gï¼ˆé‡åŠ›åŠ é€Ÿåº¦ï¼‰ | é‡åŠ›åŠ é€Ÿåº¦å–®ä½ |
| æ„Ÿæ¸¬å™¨éˆæ•åº¦ | 1 V/g | æ„Ÿæ¸¬å™¨éˆæ•åº¦ |

### C. å¸¸ç”¨Pythonå‡½å¼åº«

```python
import numpy as np              # æ•¸å€¼è¨ˆç®—
import scipy.io as sio          # è®€å–.matæª”æ¡ˆ
from scipy import signal         # ä¿¡è™Ÿè™•ç†
import matplotlib.pyplot as plt  # ç¹ªåœ–
```

---

**å ±å‘Šç”Ÿæˆæ—¥æœŸï¼š** 2024å¹´  
**è³‡æ–™é›†ç‰ˆæœ¬ï¼š** Z24 Bridge Benchmark Dataset  
**é©ç”¨ç¯„åœï¼š** çµæ§‹å¥åº·ç›£æ¸¬ã€æå‚·æª¢æ¸¬ã€æ¨¡æ…‹åˆ†æ
